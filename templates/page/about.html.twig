{# templates/page/about.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Inscription - MadaMarket{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1>Inscription</h1>

    {{ form_start(registrationForm) }}
        {{ form_errors(registrationForm) }}

        <div class="mb-3">
            {{ form_row(registrationForm.email, {'attr': {'class': 'form-control'}}) }}
        </div>

        <div class="mb-3">
            {{ form_row(registrationForm.plainPassword.first, {
                'label': 'Mot de passe',
                'attr': {'class': 'form-control'}
            }) }}
        </div>

        <div class="mb-3">
            {{ form_row(registrationForm.plainPassword.second, {
                'label': 'Répéter le mot de passe',
                'attr': {'class': 'form-control'}
            }) }}
        </div>

        <button class="btn btn-primary">S'inscrire</button>
    {{ form_end(registrationForm) }}
</div>
{% endblock %}

<?php
// ...existing code...
public function register(Request $request, UserPasswordHasherInterface $passwordHasher, EntityManagerInterface $entityManager): Response
{
    $user = new User();
    $form = $this->createForm(RegistrationFormType::class, $user);
    $form->handleRequest($request);

    if ($form->isSubmitted() && $form->isValid()) {
        $user->setPassword(
            $passwordHasher->hashPassword(
                $user,
                $form->get('plainPassword')->getData()
            )
        );

        $entityManager->persist($user);
        $entityManager->flush();

        $this->addFlash('success', 'Votre compte a été créé avec succès !');

        return $this->redirectToRoute('app_login');
    }

    return $this->render('registration/register.html.twig', [
        'registrationForm' => $form->createView(),
    ]);
}
